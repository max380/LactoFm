<!DOCTYPE html>
  <html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <link rel="stylesheet" href="css/AdminLTE.css">
    <link rel="stylesheet" href="css/radio.css">
    <link rel="stylesheet" href="font/bootstrap-icons.css">
    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon">
	<script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="js/index.js"></script>
	<script type="text/javascript" src="js/MusicControls.js"></script>
    <title>VTC Radio | Радио VTCpanel</title>
    <style>
      .index_btn {
        background: none;
        border: 1px solid rgb(221 221 221 / 62%);
        color: #ddd;
        font-size: 14px;
        width: 100%;
        padding: 6px 0;
        cursor: pointer;
      }
      .global_menu {
        width: 94vw;
      }
    </style>
  </head>
  <body style="margin: 0;">
<section>
  <div id="GlobalBackgound" style="background-image: url(img/radio.png);background-position: center;background-size: cover;filter: blur(51px);opacity: 0.4;width: 100%;height: 100vh;display: flex;justify-content: center;align-items: center;"></div>
<div style="position: absolute;top: 0;width: 100%;">
  <div class="WrapMenu page active">
    <div class="MobileHeader">
      <div><img src="img/RadioLogo.png" style="width: 125px;"></div>
    </div>
    <div class="preWrapMenu">
    <div>
    <img class="ImgSound" src="img/radio.png">
    </div>
    <div>
      <div class="progress ActiveD"><div class="pre_progress" style="width:30%;"></div></div>
    </div>
    <div>
      <div class="title">VTCpanel</div>
      <div class="pretitle">Топ чарт</div>
      <div>
        <div style="position: relative;margin: 0 auto;width: 100px;">
          <button class="ButtonPlay Clime" id="ButtonPlay" onclick="html5audio.play();">
            <i class="bi bi-play-fill" style="font-size: 26px;"></i>
          </button>
          <button class="ButtonPause" id="Load" onclick="html5audio.stop();return false;" style="display:none;">
            <img src="img/ecvoliser.gif" style="width: 100%;">
          </button>
          <button class="ButtonPause ClimeMini" id="ButtonPause" onclick="html5audio.stop();return false;" style="display:none;"> 
            <i class="bi bi-pause-fill" style="font-size: 26px;"></i>
          </button>
          <div class="UsBlock">
            <i class="bi bi-headphones" style="vertical-align: text-bottom;"></i><span class="CouOnline">12</span>
          </div>
        </div>
        <div class="ActiveA" style="margin-top: 17px;font-size: 14px;">
          <span class="blink"></span> <span>В эфире:</span> <a target="_blank" class="NameDidj" href="https://vtcpanel.com/id1">DJ VTCpanel</a>
        </div>
        <div class="pre_order">
          <div class="ActiveD">
          <button class="order">Заказать песню</button><br><br>
          </div>
          <button class="index_btn index_1">История эфира</button><br><br>
          <button class="index_btn index_2">Расписание эфира</button>
        </div>
        </div>
    </div>
    </div>
  </div>
  <div class="WrapChat page">
    <div class="shadow">
      <div class="header"><img class="LogoMenu" src="img/Logo.png" alt="VTCpanel.com"> 
        <div class="ChatTop">
          <button class="button_top a0" style="border-left: 1px solid #2b1414;">
            <div class="rtop">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" fill="white" width="18px" height="18px"><path d="M0 0h24v24H0z" fill="none"/><path d="M2 15.5v2h20v-2H2zm0-5v2h20v-2H2zm0-5v2h20v-2H2z"/></svg> МЕНЮ</div>
         </button>
         <div class="mobile">
          <button class="button_top a1" style="border-left: 1px solid #2b1414;">
           <div class="mtop"><i class="bi bi-chat-square-dots-fill"></i></div> <div class="rtop" style="margin-top: 8px;">ЧАТ</div>
         </button>
         <button class="button_top a2">
           <div class="mtop"><i class="bi bi-clock-fill"></i></div> <div class="rtop">История<br>эфира</div>
         </button>
         <button class="button_top a3">
           <div class="mtop"><i class="bi bi-calendar-week-fill"></i></div> <div class="rtop">Расписание<br>эфира</div>
         </button>
      
         <button class="button_top a4">
          <div class="mtop"><i class="bi bi-person-bounding-box"></i></div> <div class="rtop" style="margin-top: 8px;">Ведущие</div>
         </button>
         </div>
        </div>
      </div>
      <div class="Wrap">
        
        <div class="WrapPage wp1 WrActive scroll">
          <iframe src="https://vtcpanel.com/VTCRadioChat_frame.php" class="iframe" style="width: 100%;" frameborder="0"></iframe>
        </div>

       <div class="WrapPage wp2 scroll" style="height: 100%;">
        <div style="padding: 30px 30px 0;">
        <div style="font-size: 20px;margin-bottom: 10px;">История эфира:</div>
        <div>
          <table>
              <tr>
               <td><img id="track_img0" src="img/radio.png" width="50px" height="50px"></td>
               <td><span id="track0"></span></td>
             </tr>
            <tr>
              <td><img id="track_img1" src="img/radio.png" width="50px" height="50px"></td>
              <td><span id="track1">Устанавливается соединение с сервером..</span></td>
            </tr>
            <tr>
              <td><img id="track_img2" src="img/radio.png" width="50px" height="50px"></td>
              <td><span id="track2"></span></td>
            </tr>
            <tr>
             <td><img id="track_img3" src="img/radio.png" width="50px" height="50px"></td>
             <td><span id="track3"></span></td>
           </tr>
           <tr>
            <td ><img id="track_img4" src="img/radio.png" width="50px" height="50px"></td>
            <td><span id="track4"></span></td>
          </tr>
          <tr>
           <td><img id="track_img5" src="img/radio.png" width="50px" height="50px"></td>
           <td><span id="track5"></td>
           </tr>
           <tr>
            <td><img id="track_img6" src="img/radio.png" width="50px" height="50px"></td>
            <td><span id="track6"></span></td>
          </tr>
          <tr>
           <td><img id="track_img7" src="img/radio.png" width="50px" height="50px"></td>
           <td><span id="track7"></td>
           </tr>
           <tr>
             <td><img id="track_img8" src="img/radio.png" width="50px" height="50px"></td>
             <td><span id="track8"></span></td>
           </tr>
           <tr>
             <td><img id="track_img9" src="img/radio.png" width="50px" height="50px"></td>
             <td><span id="track9"></td>
             </tr>
             <tr>
               <td><img id="track_img10" src="img/radio.png" width="50px" height="50px"></td>
               <td><span id="track10"></span></td>
             </tr>
             <tr>
               <td><img id="track_img11" src="img/radio.png" width="50px" height="50px"></td>
               <td><span id="track11"></span></td>
             </tr>
             <tr>
               <td><img id="track_img12" src="img/radio.png" width="50px" height="50px"></td>
               <td><span id="track12"></span></td>
             </tr>
             <tr>
               <td><img id="track_img13" src="img/radio.png" width="50px" height="50px"></td>
               <td><span id="track13"></span></td>
             </tr>
             <tr>
               <td><img id="track_img14" src="img/radio.png" width="50px" height="50px"></td>
               <td><span id="track14"></span></td>
             </tr>
       </table>
        </div>
        </div>
       </div>

       <div class="WrapPage wp3 scroll" style="height: 100%;">
        <div class="H_iframe">

        </div>
       </div>


       <div class="WrapPage wp4 scroll" style="height: 100%;">
        <div class="DJ_iframe">

        </div>
      </div>


      </div>
      
    </div>
  </div>
  <div class="global_menu">
    <button class="global_button gb1"><i class="bi bi-broadcast"></i> ЭФИР</button>
    <button class="global_button gb2"><i class="bi bi-chat-square-dots-fill"></i> ЧАТ</button>
  </div>
</div>
</section>
<div class="PreModalOrder">
  <div class="ModalOrder">
    <button class="CloseModalOrder"><i class="bi bi-x"></i></button>
    <div class="scroll HeightModalOrder" style="height: 497px;width: 99%;">
      <div class="sc-track-request-widget" style="padding: 0;">
        <div is="track-request-widget" lang="ru" api-base="http://80.249.151.197:8080/api/v2" server-id="1" ip-timeout="600000" track-timeout="3600000" bgcolor="#171717" bgopacity="1" tracks_num="20" track_width="180" track_image_default="img/radio.png" meta_font_size="14" meta_font_style="normal" meta_font_color="#dedede" meta_opacity="1" button_color="#0c4613" button_color_active="#09531c" button_font_color="#00ff2a" button_font_size="14" ordering="3" allow_person_and_message="true" modal_background_color="#171717" modal_font_color="#cccccc" modal_background_opacity="1">
      </div>
    </div>
  </div>
  </div>
</div>
<script src="js/jQuery-2.2.0.min.js"></script>
<script src="js/jquery-ui.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script>
MusicControls.create({
  track       : 'Time is Running Out',   
  artist      : 'Muse',           
  cover       : 'albums/absolution.jpg',   

  isPlaying   : true,             
  dismissable : true,             

  // hide previous/next/close buttons:
  hasPrev   : false,    
  hasNext   : false,   
  hasClose  : true,   


  ticker    : 'Now playing "Time is Running Out"',

  playIcon: 'media_play',
  pauseIcon: 'media_pause',
  prevIcon: 'media_prev',
  nextIcon: 'media_next',
  closeIcon: 'media_close',
  notificationIcon: 'notification'
}, onSuccess, onError);
MusicControls.destroy(onSuccess, onError);
MusicControls.updateIsPlaying(true);
MusicControls.updateDismissable(true);
function events(action) {
  switch(action.message) {
    case 'music-controls-next':
      // Do something
      break;
    case 'music-controls-previous':
      // Do something
      break;
    case 'music-controls-pause':
      // Do something
      break;
    case 'music-controls-play':
      // Do something
      break;
    case 'music-controls-destroy':
      // Do something
      break;



    // Headset events (Android only)
    // All media button events are listed below
    case 'ButtonPlay' :
      // Do something
      break;
    case 'music-controls-headset-unplugged':
      // Do something
      break;
    case 'music-controls-headset-plugged':
      // Do something
      break;
    default:
      break;
  }
}

// Register callback.  NOTE: Only one callback can be registered at a time.
MusicControls.subscribe(events);

// Start listening for events.  NOTE: the subscribe callback will not be called unless MusicControls.listen() is called
MusicControls.listen();
</script>
<script type="text/javascript">
function setHeiHeight(){var e;e=580<$(window).width()?86:147,$(".Wrap, .iframe").css({height:$(window).height()-e+"px"})}setHeiHeight(),$(window).resize(setHeiHeight),$(".a0").click(function(){$(".a1, .a2, .a3, .a4").addClass("show_a")}),$(".gb1").click(function(){$(".WrapMenu").addClass("active"),$(".WrapChat").removeClass("active")}),$(".gb2").click(function(){$(".WrapChat").addClass("active"),$(".WrapMenu").removeClass("active"),$('.WrapPage').removeClass('WrActive'),$('.wp1').addClass('WrActive')}),$(".a1").click(function(){$(".WrapPage").removeClass("WrActive"),$(".wp1").addClass("WrActive"),$(".Mes1, .Mes2").show()}),$(".a2").click(function(){$(".WrapPage").removeClass("WrActive"),$(".wp2").addClass("WrActive"),$(".Mes1, .Mes2").hide()}),$(".a3").click(function(){$(".WrapPage").removeClass("WrActive"),$(".wp3").addClass("WrActive"),$(".Mes1, .Mes2").hide()}),$(".a4").click(function(){$(".WrapPage").removeClass("WrActive"),$(".wp4").addClass("WrActive"),$(".Mes1, .Mes2").hide()}),$(document).on("click","body",function(e){0==$(e.target).closest(".a0").length&&$(".a1, .a2, .a3, .a4").removeClass("show_a")});
var progressTimer,playButton=document.getElementById("ButtonPlay"),stopButton=document.getElementById("ButtonPause"),activityIndicator=document.getElementById("Load");function onError(t){console.log(t.message)}function onConfirmRetry(t){1==t&&html5audio.play()}var readyStateInterval=null;
$('.index_1').click(function(){
  $('.WrapChat').addClass('active');
  $('.WrapMenu').removeClass('active');
  $('.WrapPage').removeClass('WrActive');
  $('.wp2').addClass('WrActive');
});
$('.index_2').click(function(){
  $('.WrapChat').addClass('active');
  $('.WrapMenu').removeClass('active');
  $('.WrapPage').removeClass('WrActive');
  $('.wp3').addClass('WrActive');
});
var html5audio = {
  play: function()
  {
    isPlaying = true;
    myaudioURL = 'http://80.249.151.197:8000/stream';
    myaudio = new Audio(myaudioURL);
    myaudio.play();
    myaudio.volume = 0.6;
    readyStateInterval = setInterval(function(){
       if (myaudio.readyState <= 1) {
         playButton.style.display = 'none';
         activityIndicator.style.display = 'inline-block';
       }
    },10000);
    var g = $('.CouOnline').html();
    $('.CouOnline').html(+g + 1);
    myaudio.addEventListener("error", function() {
       console.log('VTC Radio ERROR');
    }, false);
    myaudio.addEventListener("canplay", function() {
       console.log('VTC Radio CAN PLAY');
    }, false);
    myaudio.addEventListener("waiting", function() {
       //console.log('myaudio WAITING');
       isPlaying = false;
       playButton.style.display = 'none';
       stopButton.style.display = 'none';
       activityIndicator.style.display = 'inline-block';
    }, false);
    myaudio.addEventListener("playing", function() {
       isPlaying = true;
       playButton.style.display = 'none';
       activityIndicator.style.display = 'none';
       stopButton.style.display = 'inline-block';
    }, false);

    myaudio.addEventListener("ended", function() {
       console.log('myaudio ENDED');
      html5audio.stop();  
       navigator.notification.alert('Streaming failed. Possibly due to a network error.', null, 'Stream error', 'OK');
        navigator.notification.confirm('Streaming failed. Possibly due to a network error.',onConfirmRetry,'Stream error','Retry,OK'
        );
       if (window.confirm('Streaming failed. Possibly due to a network error. Retry?')) {
        onConfirmRetry();
       }
    }, false);
  },
  stop: function() {
    isPlaying = false;
    clearInterval(readyStateInterval);
    myaudio.pause();  
    stopButton.style.display = 'none';
    activityIndicator.style.display = 'none';
    playButton.style.display = 'inline-block';
    myaudio = null;
  }
};
$( document ).ready(function() {
 function updateTrack(){
   $.ajax({
 url: "http://80.249.151.197:8080/api/v2/history/?server=1&limit=1&callback=callback&format=jsonp",
 jsonp: "callback",
 dataType: "jsonp",
 method: "GET",
  success: function( response ) {
  var ts,length,percent;0<response.results[0].length?($(".ActiveD").show(),$(".ActiveA").hide(),ts=response.results[0].ts,length=response.results[0].length,100<(percent=100*($.now()-ts)/length)&&(percent=100),$(".pre_progress").css("width",percent+"%")):($(".ActiveD").hide(),$(".ActiveA").show(),$AdminArr=response.results[0].dj_name.split(" - "),null!=$AdminArr[1]?($(".NameDidj").html($AdminArr[1]),$(".NameDidj").attr("href","https://vtcpanel.com/id"+$AdminArr[0])):($(".NameDidj").html($AdminArr[0]),$(".NameDidj").attr("href","https://vtcpanel.com/")));
 ""!=response.results[0].author?($(".pretitle").text(response.results[0].title),$(".title").text(response.results[0].author)):($metaArr=response.results[0].metadata.split(" - "),$(".title").text($metaArr[0]),$(".pretitle").text($metaArr[1]));
  null!=response.results[0].img_large_url&&""!=response.results[0].img_large_url?($(".ImgSound").attr("src",response.results[0].img_large_url),$("#GlobalBackgound").css("background-image","url("+response.results[0].img_large_url+")")):null!=response.results[0].img_url&&""!=response.results[0].img_url?($(".ImgSound").attr("src",response.results[0].img_url),$("#GlobalBackgound").css("background-image","url("+response.results[0].img_url+")")):($(".ImgSound").attr("src","img/radio.png"),$("#GlobalBackgound").css("background-image","url(img/radio.png)"));
 }
});
 }
 updateTrack();
 setInterval(updateTrack, 5000);
 function updateHistory(){
   $.ajax({
     url: "http://80.249.151.197:8080/api/v2/history/?server=1&limit=15&callback=callback&format=jsonp",
     jsonp: "callback",
     dataType: "jsonp",
     method: "GET",
     success: function( response ) {
       for(var i=0;i<15;++i)$("#track"+i).text(response.results[i].metadata),null!=response.results[i].img_url&&""!=response.results[i].img_url?$("#track_img"+i).attr("src",response.results[i].img_url):$("#track_img"+i).attr("src","img/radio.png");
     }
   });
 }
 updateHistory();
 $('.a2, .index_1').click(function(){
  updateHistory();
  setInterval(updateHistory, 15000);
});
function CouOnline(){$.ajax({url:"http://80.249.151.197:8080/api/channels/?server=1&callback=callback&format=jsonp",jsonp:"callback",dataType:"jsonp",method:"GET",success:function(a){$(".CouOnline").text(a.objects[0].listeners_air)}})}
 CouOnline();
 setInterval(CouOnline, 30000);
});
$(".order").click(function(){$(".HeightModalOrder").css({height:$(window).height()-61+"px"}),$(".PreModalOrder").show()}),$(".PreModalOrder").click(function(e){0==$(e.target).closest(".HeightModalOrder").length&&$(".PreModalOrder").hide()});

$(".a4").click(function(){var a;$(".DJ_iframe").html('<iframe src="https://vtcpanel.com/VTCRadioDJ_frame.php" class="iframe iframe_load" style="width: 100%;" frameborder="0"></iframe>'),a=580<$(window).width()?91:152,$(".iframe_load").css({height:$(window).height()-a+"px"})}),$(".a3,.index_2").click(function(){var a;$(".H_iframe").html('<iframe src="https://vtcpanel.com/VTCRadioH_frame.php" class="iframe iframe_load" style="width: 100%;" frameborder="0"></iframe>'),a=580<$(window).width()?91:152,$(".iframe_load").css({height:$(window).height()-a+"px"})});
</script>
<script type="text/javascript" src="js/request_widget.js"></script>
</body>
</html>